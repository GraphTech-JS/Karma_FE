{{ $product := .product | default dict }}
{{ $category := .category | default dict }}
{{ $context := .context }}

{{/* Get product data with fallbacks */}}
{{ $productName := $product.name | default $context.Title }}
{{ $productImage := $product.image | default $context.Params.image | default "/img/Stack-product.png" }}
{{ $categoryName := $category.name | default "Політні стеки" }}

<section class="overflow-hidden relative bg-white">
    <!-- Background decorative elements -->
       {{ $bgEl1 := resources.Get "img/bg-el-1.png" }}
    {{ if $bgEl1 }}
    {{ $bgEl1Processed := $bgEl1.Resize "420x webp q80" }}
    <img src="{{ $bgEl1Processed.RelPermalink }}" alt="Декоративний фоновий елемент" aria-hidden="true"
        class="absolute z-[1] right-[-40px] lg:right-[-14px] top-[-42px] md:top-[-65px] lg:top-[-60px] w-[201px] h-[185px] md:w-[325px] md:h-[298px] lg:w-[325px] lg:h-[298px]" />
    {{ else }}
    <img src="/img/bg-el-1.png" alt="Декоративний фоновий елемент" aria-hidden="true"
        class="absolute z-[1] right-[-40px] lg:right-[-14px] -top-[65px] lg:top-[-60px] w-[201px] h-[185px] md:w-[325px] md:h-[298px] lg:w-[325px] lg:h-[298px]" />
    {{ end }}

    {{ $bgEl2 := resources.Get "img/bg-el-2.png" }}
    {{ if $bgEl2 }}
    {{ $bgEl2Processed := $bgEl2.Resize "420x webp q80" }}
    <img src="{{ $bgEl2Processed.RelPermalink }}" alt="Декоративний фоновий елемент" aria-hidden="true"
        class="hidden md:block absolute z-[1]  bottom-0 left-0 w-[171px] h-[199px] md:w-[217px] md:h-[253px] lg:w-[266px] lg:h-[310px]" />
    {{ else }}
    <img src="/img/bg-el-2.png" alt="Декоративний фоновий елемент" aria-hidden="true"
        class="hidden md:block absolute z-[1] x] bottom-0 left-0 w-[171px] h-[199px] md:w-[217px] md:h-[253px] lg:w-[266px] lg:h-[310px]" />
    {{ end }}
    <div
        class="w-full max-w-[1200px] flex flex-col mx-auto px-[20px] pt-[20px] mb:pt-[46px] lg:pt-[40px] relative z-[2] max-lg:mb-[28px]">
        <nav aria-label="Breadcrumb navigation"
            class="flex flex-row items-start font-[Montserrat] gap-[clamp(8px,2vw,16px)] mb-[clamp(20px,4vw,40px)]">
            <ol class="flex flex-wrap items-center gap-[clamp(4px,1vw,8px)]">
                <li>
                    <a class="font-[Montserrat] text-[clamp(16px,2vw,20px)] font-normal text-[#ba0108] hover:underline"
                        href="/">
                        Головна
                    </a>
                </li>
                <li class="text-[#ba0108] sm:inline" aria-hidden="true">&rarr;</li>
                <li>
                    <a class="font-[Montserrat] text-[clamp(16px,2vw,20px)] font-normal text-[#ba0108] hover:underline"
                        href="/catalog/{{ $context.Params.category | default " politni-steky" }}/">
                        {{ $categoryName }}
                    </a>
                </li>
                <li class="text-[#ba0108] sm:inline" aria-hidden="true">&rarr;</li>
                <li>
                    <span class="font-[Montserrat] text-[clamp(16px,2vw,20px)] font-normal text-[#ba0108]">
                        {{ $productName }}
                    </span>
                </li>
            </ol>
        </nav>

        <div
            class="flex flex-col justify-between items-center mx-0 w-full ">
            <div class="flex relative flex-col justify-start items-center w-full md:flex-row gap-[43px] md:gap-[62px]   ">
                {{ $productImageResource := resources.Get $productImage }}
                {{ if $productImageResource }}
                {{ $productImageProcessed := $productImageResource.Resize "502x367 webp q80" }}
                <img src="{{ $productImageProcessed.RelPermalink }}" alt="{{ $productName }}" class="object-contain max-w-none relative z-10
                             w-full h-[230px] md:w-[368px] md:h-[310px] lg:w-[502px] lg:h-[367px]" />
                {{ else }}
                <img src="{{ $productImage }}" alt="{{ $productName }}" class="object-contain max-w-none relative z-10
                                w-full h-[230px] md:w-[368px] md:h-[310px] lg:w-[502px] lg:h-[367px]" />
                {{ end }}

                <div
                    class="pointer-events-none absolute bottom-19 left-[20%] sm:left-[22%] md:left-[8%] lg:left-[4%] xl:left-[4%] w-[clamp(120px,15vw,410px)] h-[clamp(15px,2vw,80px)] rounded-full bg-[#020303] opacity-15 blur-[33.65px] z-0 hidden sm:block" />
            </div>
            <div
                class="flex flex-col items-center w-full md:items-start lg:items-start mt-[clamp(20px,4vw,43px)] sm:mt-[20px] md:mt-0 md:w-[531px] lg:w-[578px]">
                <h2
                    class="hero-title font-[Unbounded] text-[#ba0108] uppercase leading-[1.1]  mb-[12px] text-[32px] md:text-[48px] w-full max-w-[min(768px,85vw)] font-medium text-center md:text-left">
                    ПОЛІТНИЙ СТЕК<br><span class="text-black">KARMA F405 V1</span>
                </h2>
                <p
                    class="font-[Montserrat] text-[clamp(16px,2vw,24px)] leading-[1.7] text-[#020303] w-full max-w-[min(768px,85vw)] text-left mb-[20px]">
                    {{ $context.Params.description | default "Політний стек спрощує монтаж та підключення електроніки в дроні, роблячи його ідеальним рішенням як для досвідчених пілотів, так і для початківців." }}
                </p>
                <p
                    class="font-[Montserrat] text-[clamp(16px,2vw,24px)] leading-[1.7] text-[#020303] w-full max-w-[min(768px,85vw)] text-left mb-[57px]">
                    Він забезпечує стабільний політ, точне керування та ефективне розподілення потужності до моторів.
                </p>
                <button onclick="window.openContactModal()"
                    aria-label="Отримати комерційну пропозицію для {{ $productName }}"
                    class="product-hero-button cursor-pointer !font-[Montserrat] text-[clamp(16px,2vw,24px)] font-light md:font-normal lg:font-medium text-white bg-[#ba0108] hover:bg-[#e39599] transition-colors w-full py-[clamp(25px,3vw,20px)] px-[clamp(24px,4vw,40px)] rounded-[20px]">
                    Отримати пропозицію
                </button>
            </div>
        </div>
    </div>
</section>


<style>
    @keyframes fadeInUp {
    0% {
      opacity: 0;
      transform: translateY(30px);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .hero-title {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.6s ease-out;
  }

  .hero-title.animate {
    animation: fadeInUp 0.8s ease-out forwards;
  }
</style>


<script>
  // Hero title animation
  function animateHeroTitle() {
    const heroTitles = document.querySelectorAll('.hero-title');

    const observerOptions = {
      threshold: 0.3,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate');
        } else {
          entry.target.classList.remove('animate');
        }
      });
    }, observerOptions);

    heroTitles.forEach(title => {
      observer.observe(title);
    });
  }

  // Initialize when DOM is loaded
  document.addEventListener('DOMContentLoaded', animateHeroTitle);
</script>